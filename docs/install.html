<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; mercure Version 0.4.0-beta.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Usage" href="usage/index.html" />
    <link rel="prev" title="Quick Start" href="quickstart.html" />
<a href="https://mercure-imaging.zulipchat.com" target="_none" class="chat-button" title="Open mercure online community">Open Chat</a>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/mercure_logo_w.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Version 0.4.0-beta.6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/mercure-imaging/mercure">github.com/mercure-imaging/mercure</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">What is mercure?</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation-types">Installation Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-mercure">Installing mercure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#locations">Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#congratulations">Congratulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dicom-tls-support">DICOM TLS Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/index.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring.html">Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboards.html">Dashboard Gallery</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Module Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_list.html">Existing Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="anonymizer.html">Anonymizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="dcmannotate.html">DCMAnnotate</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Discussion Board</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release History</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/index.html">Code Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mercure</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Installation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h1>
<p>It is recommended to install mercure on a Linux machine running Ubuntu Server 24.04 LTS 64bit (or newer). The installer for the Ubuntu operating system can be downloaded at <a class="reference external" href="https://ubuntu.com/download/server">https://ubuntu.com/download/server</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>mercure might run on other Linux distributions as well, but the installation script will not work without modification. When trying to install mercure on other Linux distributions, it might be best to focus on a Docker-based installation and derive a custom installation script from the script included in the repository.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>mercure servers and the web-based user interface should <strong>NEVER</strong> be placed on the internet! mercure has been designed for use in intranet environments that are secured against unauthorized access. It has not been hardened and tested for installation on the public internet. Also, DICOM transfers should never be made over the public internet (unless encrypted and secured transfer protocols are used, e.g. based on  DICOMweb).</p>
</div>
<section id="installation-types">
<h2>Installation Types<a class="headerlink" href="#installation-types" title="Permalink to this heading"></a></h2>
<p>mercure can be installed in three different ways:</p>
<ul class="simple">
<li><p>Using systemd as service runner</p></li>
<li><p>Using Docker as service runner</p></li>
<li><p>Using Nomad for orchestrating the services</p></li>
</ul>
<p>Which installation type should you choose? It depends on the use case. For normal users, either a Docker-based or systemd-based installation is best suited. A systemd-based installation might have a small performance advantage, while a Docker-based installation will be easier to upgrade to newer mercure versions. If you are planning to actively develop and customize mercure, a systemd-based installation should be preferred.</p>
<p>With both systemd- and Docker-based installations, processing modules are executed sequentially, i.e. the requested processing module is launched inside a Docker container and the processor service waits until the processing has finished. With a Nomad-based installation, multiple processing modules can be executed in parallel. In this case, the processor service launches processing modules asynchronously and fetches results from the processing containers when the processing has finished. Moreover, the processor can distribute the processing jobs across multiple compute nodes, i.e. you can operate a processing cluster. This might be important if you are planning to integrate computationally demanding processing algorithms and if you are expecting a large volume of processing jobs. It is also relevant if you are planning to operate processing modules with different hardware requirements, because the Nomad-based solution allows defining resource requirements for jobs. However, these functions may not be needed in many situations. Nomad-based installations are more complex and intended for advanced users.</p>
</section>
<section id="installing-mercure">
<h2>Installing mercure<a class="headerlink" href="#installing-mercure" title="Permalink to this heading"></a></h2>
<p>After deciding on the type of mercure installation, open a terminal shell of your Ubuntu installation for a user with sudo rights. Clone the mercure repository into the home folder of the user by typing the commands below. This will install the latest stable version, which is recommended. If you would like to install a specific version instead, replace “latest-stable” with the desired version tag. A list of all released versions can be <a class="reference external" href="https://github.com/mercure-imaging/mercure/releases">found here</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~</span>
<span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">branch</span> <span class="n">latest</span><span class="o">-</span><span class="n">stable</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mercure</span><span class="o">-</span><span class="n">imaging</span><span class="o">/</span><span class="n">mercure</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">mercure</span>
</pre></div>
</div>
<p>Call the installation script and put the installation type as argument (“systemd” or “docker” or “nomad”):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">install</span><span class="o">.</span><span class="n">sh</span> <span class="n">systemd</span>
</pre></div>
</div>
<p>The script will now perform all relevant installation steps, including installation of Docker and Python runtime environments. It will also create the user “mercure”, which will be used for running the mercure processes.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When installing mercure in Docker mode, the option “-b” can be used to enforce that the docker containers are rebuilt (instead of downloaded from Docker Hub). This might be helpful if you are interested in new features that have not been published as release yet. Moreover, the option “-d” selects the development version instead of the stable version.</p>
</div>
</section>
<section id="locations">
<h2>Locations<a class="headerlink" href="#locations" title="Permalink to this heading"></a></h2>
<p>By default, mercure is installed in the folder <strong>/opt/mercure</strong>. If necessary, the location can be changed after the installation (see note below), but this is not recommended. The installer will always use the default path.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Folder</p></th>
<th class="head"><p>Content</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/opt/mercure</p></td>
<td><p>Base installation folder</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/mercure/app</p></td>
<td><p>Application source code</p></td>
</tr>
<tr class="row-even"><td><p>/opt/mercure/config</p></td>
<td><p>Configuration files</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/mercure/data</p></td>
<td><p>Folders for buffering images</p></td>
</tr>
<tr class="row-even"><td><p>/opt/mercure/db</p></td>
<td><p>Database of the bookkeeper</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you need to change the installation location, set the environment variable MERCURE_CONFIG_FOLDER to the new location where the configuration files can be found. Then, change the paths of the data folders in the configuration file mercure.json. Finally, change the application startup scripts depending on your installation type. In the case of a systemd installation, this means adjusting mercure’s .service files found in the folder /etc/systemd/system.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The source code located in the /app folder is directly executed only for systemd-type installations. Docker and Nomad installations execute container images instead. By default, these images are downloaded from Docker Hub. If you want to modify the mercure source code, you need to rebuild the container images for the changes to go into effect. This can be done with the script build-docker.sh.</p>
</div>
</section>
<section id="congratulations">
<h2>Congratulations<a class="headerlink" href="#congratulations" title="Permalink to this heading"></a></h2>
<p>If you have made it to here, then you have mastered the installation of mercure. You should now be able to access mercure’s user interface with a web browser by entering your server’s IP address and adding :8000 (e.g., 192.168.56.1:8000).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can change the port used for the web interface from 8000 to another port by editing the file webgui.env in mercure’s configuration folder. Make sure to restart the webgui service afterwards. Also, if running Docker or Nomad (or testing mercure with Vagrant), make sure to modify the port mapping to the host system as well.</p>
</div>
</section>
<section id="dicom-tls-support">
<h2>DICOM TLS Support<a class="headerlink" href="#dicom-tls-support" title="Permalink to this heading"></a></h2>
<p>The following steps are necessary if you need encrypted DICOM communication via the DICOM-TLS protocol. This is usually not required when sending DICOMs only inside a protected intranet network. However, it is strongly recommended when sending DICOMs over unsecurced network connections.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Support for the DICOM TLS receiver mode is still experimental and should be used with care.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Due to an incompatibility in DCMTK v3.6.4 and OpenSSL v1.1.1, the versions supported by Ubuntu 20.04, only mercure installations on Ubuntu 22.04 or newer support DICOM TLS reception.</p>
</div>
<p>The following environment variables must be defined to run mercure in DICOM TLS receiver mode. This can be done, for example, by adding the values to the /etc/environment file. First, set <cite>MERCURE_TLS_ENABLED</cite> to <cite>1</cite>. Next, specify the paths to your server TLS key, certificate, and CA certificate, as shown in the below sample configuration.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Environment Variable</p></th>
<th class="head"><p>Example Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MERCURE_TLS_ENABLED</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>MERCURE_TLS_KEY</p></td>
<td><p>/opt/mercure/tls/private_key.pem</p></td>
</tr>
<tr class="row-even"><td><p>MERCURE_TLS_CERT</p></td>
<td><p>/opt/mercure/tls/certificate.pem</p></td>
</tr>
<tr class="row-odd"><td><p>MERCURE_TLS_CA_CERT</p></td>
<td><p>/opt/mercure/tls/CA_certificate.pem</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example shows how to create your own Certificate Authority (CA) to self-sign your own certificates. In production, you will likely use your organization’s certificate authority to sign the TLS receiver certificate, or create an intermediate CA from your organizational CA to sign CSR when generating certificates.</p>
</div>
<p>Here are some example steps to create a self-signed certificate authority and TLS key/certificate that can be utilized for use mercure in DICOM TLS receiver mode.</p>
<ul class="simple">
<li><p>Step 1: Generate the CA key: <cite>openssl genrsa -out CA_key.pem 4096</cite></p></li>
<li><p>Step 2: Create the CA certificate: <cite>openssl req -new -x509 -days 3650 -key CA_key.pem -out CA_certificate.pem</cite></p></li>
<li><p>Step 3: Create a TLS private key: <cite>openssl genrsa -out SCP_private_key.pem 4096</cite></p></li>
<li><p>Step 4: Create a CSR (Certificate Signing Request) with the TLS private key: <cite>openssl req -new -key private_key.pem -out receiver_csr.pem</cite></p></li>
<li><p>Step 5: Sign the CSR with the CA private key and certificate to generate the TLS certificate: <cite>openssl x509 -req -days 3650 -in receiver_csr.pem -CA CA_certificate.pem -CAkey CA_key.pem -CAcreateserial -out certificate.pem</cite></p></li>
<li><p>Step 6: Verify that the generated TLS certificate is valid against the CA certificate: <cite>openssl verify -CAfile CA_certificate.pem certificate.pem</cite></p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When creating the CSR, ensure that the CSR common name is NOT the same as the CA common name. If so, the openssl certificate validation will fail and you will not be able to receive DICOM data over TLS.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember to add both your TLS receiver private key (private_key.pem), certificate file (certificate.pem), and CA certificate file (CA_certificate.pem) to the file system of your mercure installation and specify the above environment variables to enable TLS receiver mode.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usage/index.html" class="btn btn-neutral float-right" title="Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2025 The &#34;mercure&#34; authors and contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions">
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>